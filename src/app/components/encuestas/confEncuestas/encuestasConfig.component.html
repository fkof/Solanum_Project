<div class="container-general">
    <p-toast></p-toast>
    <p-confirmDialog></p-confirmDialog>
    <p-card>
        <ng-template pTemplate="header">
            <div class="card-header">
                <div class="header-content">
                    <h2 class="header-title">Configuraci√≥n de Encuestas</h2>
                    <p class="header-subtitle">Configura las encuestas para los colaboradores</p>
                </div>

            </div>
        </ng-template>

        <div class="form-field">
            <div class="form-grid">
                <div class="form-field">
                    <label class="field-label">Link</label>
                    <input pInputText type="text" [(ngModel)]="encuesta.link" placeholder="Link" class="search-input" />
                </div>
                <div class="form-field">
                    <label class="field-label">Rol </label>
                    <p-multiselect [options]="arrayRoles" [(ngModel)]="selectedRoles" optionLabel="nombre"
                        placeholder="Selecciona un rol" [maxSelectedLabels]="3" class="w-full md:w-80" />
                </div>
                <p-button label="Guardar Encuesta" icon="pi pi-save" (onClick)="saveEncuesta()"
                    styleClass="p-button-primary"></p-button>
            </div>
            <p-table #dt [value]="arrayEncuestas" [loading]="loading" [paginator]="true" [rows]="10"
                [rowsPerPageOptions]="[5, 10, 20, 50]" [showCurrentPageReport]="true"
                currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} roles"
                [globalFilterFields]="['nombre', 'descripcion']" [tableStyle]="{ 'min-width': '50rem' }"
                styleClass="p-datatable-gridlines">


                <ng-template pTemplate="header">
                    <tr>

                        <th pSortableColumn="link" style="max-width: 170px;min-width: 170px">
                            Link <p-sortIcon field="link"></p-sortIcon>
                        </th>
                        <th pSortableColumn="idRoles" style="max-width: 150px;min-width: 150px">
                            Roles Asignados <p-sortIcon field="idRoles"></p-sortIcon>
                        </th>
                        <th style="width: 140px">Acciones</th>
                    </tr>
                </ng-template>

                <ng-template pTemplate="body" let-img>
                    <tr>

                        <td style="max-width: 170px;min-width: 170px">
                            <span class="wrapColumna">{{ img.link }}</span>
                        </td>
                        <td style="max-width: 150px;min-width: 150px">
                            <span class="nombre-rol">{{ img.rolesDescripcion }}</span>
                        </td>
                        <td>
                            <div class="action-buttons">
                                <p-button icon="pi pi-pencil" (onClick)="selectEncuestaEdit(img)" [pTooltip]="'Editar'"
                                    styleClass="p-button-rounded p-button-text p-button-info edit-btn"
                                    tooltipPosition="top"></p-button>
                                <p-button icon="pi pi-trash" (onClick)="deleteEncuesta(img.idEncuesta)"
                                    styleClass="p-button-rounded p-button-text p-button-danger delete-btn"
                                    [pTooltip]="'Eliminar'" tooltipPosition="top"></p-button>
                            </div>
                        </td>
                    </tr>
                </ng-template>

                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td colspan="5" class="empty-message">
                            <div class="empty-state">
                                <i class="pi pi-inbox empty-icon"></i>
                                <p>No se encontraron encuestas</p>
                            </div>
                        </td>
                    </tr>
                </ng-template>

                <ng-template pTemplate="loadingbody">
                    <tr>
                        <td colspan="5">
                            <div class="loading-state">
                                <i class="pi pi-spin pi-spinner loading-icon"></i>
                                <p>Cargando encuestas...</p>
                            </div>
                        </td>
                    </tr>
                </ng-template>
            </p-table>

        </div>




    </p-card>

</div>